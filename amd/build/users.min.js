define("local_registration/users",["jquery","local_datatables/repository","local_datatables/datatables/dataTables.helper","core/notification","local_datatables/datatables/dataTables.dateTime","local_datatables/datatables/moment","local_datatables/datatables/i18n/en-GB","local_datatables/datatables/i18n/el-GR","local_datatables/datatables/jquery.dataTables","local_datatables/datatables/dataTables.bootstrap4","local_datatables/datatables/dataTables.responsive","local_datatables/datatables/responsive.bootstrap4","local_datatables/datatables/dataTables.buttons","local_datatables/datatables/buttons.bootstrap4","local_datatables/datatables/buttons.colVis","local_datatables/datatables/buttons.html5","local_datatables/datatables/buttons.print","local_datatables/bootstrap-select/bootstrap-select"],(function($,Repository,Helper,Notification,DateTime,moment,languageENGB,languageELGR){return{init:function(){$((function(){var table=$("#users").DataTable({initComplete:function(){var typingTimer;$("#users .filters").on("keyup","input",(function(){clearTimeout(typingTimer),typingTimer=setTimeout(function(){table.column($(this).data("index")).search(this.value).draw()}.bind(this),500)})),$("#users .filters").on("keydown","input",(function(){clearTimeout(typingTimer)})),$("#users .filters").on("change","select",(function(){var selectedValues=$(this).val();Array.isArray(selectedValues)&&selectedValues.length>1?table.column($(this).data("index")).search(selectedValues.join("|"),!0,!1).draw():table.column($(this).data("index")).search(selectedValues).draw()}));var datetimeElements=document.querySelectorAll(".datetime");datetimeElements&&datetimeElements.forEach((function(element){var index=element.getAttribute("data-index");DateTime.use(moment),new DateTime(element,{format:"DD/MM/YY",buttons:{clear:!0},onChange:function(value,date,input){table.column(index).search(value).draw()}})})),$("#users").removeClass("hidden"),$(".selectpicker").selectpicker("render"),Helper.initResponsiveTable(table)},processing:!0,serverSide:!0,ajax:function(data,callback){Repository.process({data:JSON.stringify(data),namespace:"local_registration",tableid:"users"}).then((function(json){callback(JSON.parse(json))})).catch((function(error){Notification.exception(error)}))},searchDelay:400,orderCellsTop:!0,fixedHeader:!0,language:languageENGB,responsive:{details:{type:"column",target:0}},paging:!0,order:[[1,"asc"]],lengthChange:!0,lengthMenu:[[10,20,30,-1],[10,20,30,"All"]],columns:[{defaultContent:""},{data:"firstname",name:"firstname"},{data:"lastname",name:"lastname"},{data:"email",name:"email",render:function(data,type,row){return 1==row.notified?row.email+'<br><span class="badge bg-warning">'+M.util.get_string("notified","local_registration")+"</span>":row.email}},{data:"tenantname",name:"t.id",orderable:"t.name",searchable:"equals||t.name"},{data:"country_formatted",name:"country",orderable:"country_text",searchable:"equals||country_text"},{data:"gender",name:"gender",searchable:"equals"},{data:"domain",name:"domain",searchable:"equals"},{data:"comments",name:"comments"},{data:"interests_formatted",name:"interests"},{data:"confirmed_formatted",name:"confirmed",orderable:"confirmed_text",searchable:"equals||confirmed_text"},{data:"timecreated_formatted",name:"lr.timecreated",searchable:"datetime"},{data:"assessor_text",name:"assessor_expr",orderable:"assessor_text",searchable:"assessor_expr||assessor_text"},{data:{},render:function(data){var btnApprove='<button class="btn btn-success btn-sm btn-approve" data-action="approve" data-id="'+data.id+'">'+M.util.get_string("approve","local_registration")+"</button>",btnReject='<button class="btn btn-danger btn-sm btn-reject" data-action="reject" data-id="'+data.id+'">'+M.util.get_string("reject","local_registration")+"</button>",btnNotify="";return 1!==data.notified&&(btnNotify='<button class="btn btn-warning btn-sm btn-notify" data-action="notify" data-id="'+data.id+'">'+M.util.get_string("notify","local_registration")+"</button>"),'<span class="buttons" data-value="'+data.id+'">'+btnApprove+btnReject+btnNotify+" </span>"},name:"actions",orderable:!1,searchable:!1}],columnDefs:[{targets:0,className:"dtr-control noVis",orderable:!1,searchable:!1}],dom:"<B<l><t>ftrip>",buttons:[{extend:"collection",className:"exportButton",text:"Export",buttons:[{extend:"copy",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"print",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"excel",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"csv",exportOptions:{columns:":visible:not(.noVis)"}}]},{extend:"colvis",columns:":not(.noVis)"}]});table.on("click",".btn-approve",Helper.createModalForm(table,"approve","modal:approvetitle","modal:approvesuccess","local_registration")),table.on("click",".btn-reject",Helper.createModalForm(table,"reject","modal:rejecttitle","modal:rejectsuccess","local_registration")),table.on("click",".btn-notify",Helper.createModalForm(table,"notify","modal:notifytitle","modal:notifysuccess","local_registration")),table.on("click",".reset-filters",(function(){Helper.resetTableFilters(table,!1)}))}))}}}));

//# sourceMappingURL=users.min.js.map